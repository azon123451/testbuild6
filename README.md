# Бот поддержки в Telegram

Асинхронный Telegram-бот на **aiogram 3**, который ставит клиентов в очередь, даёт операторам брать их в работу и сохраняет историю переписки в SQLite.

## Требования
- Python 3.11+
- Виртуальное окружение (рекомендуется)
- Токен бота от [@BotFather](https://t.me/BotFather)
- ID операторов (узнать можно через [@userinfobot](https://t.me/userinfobot))

## Развёртывание
1. Клонируйте/скопируйте проект в рабочую директорию.
2. Создайте и активируйте окружение:
   ```bash
   python -m venv .venv
   .\.venv\Scripts\activate             # Windows
   source .venv/bin/activate            # Linux/macOS
   ```
3. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
4. Настройте переменные окружения:
   - Скопируйте `env.sample` в `.env` (или экспортируйте значения иным способом).
   - Укажите:
     - `BOT_TOKEN` — токен вашего бота.
     - `OPERATORS` — список ID операторов через запятую.
     - Опционально `DB_PATH` — путь к файлу SQLite (по умолчанию `support_bot.db`).
5. Запустите бота:
   ```bash
   python main.py
   ```

Бот автоматически создаст базу `support_bot.db` и начнёт опрашивать Telegram. Завершение — `Ctrl+C`.

## Полезно знать
- Очередь клиентов и соответствия операторов живут в памяти процесса, поэтому при рестарте они очищаются.
- История сообщений сохраняется в SQLite и доступна операторам при повторном контакте клиента.
- Параметр `protect_content=True` отключает пересылку/скриншоты у клиентов.
- Для продакшн-развёртывания используйте процесс-менеджер (например, `systemd`, `pm2`, `supervisor`) и мониторьте логи `logging` (по умолчанию уровень INFO).

